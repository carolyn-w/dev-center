(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{133:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return d}));var a=n(2),i=n(9),o=(n(0),n(298)),r={},s={id:"mobile/snippets/quickstart-prereqs",isDocsHomePage:!1,title:"quickstart-prereqs",description:"Check out and setup the Geocortex Mobile SDK Quickstart project.",source:"@site/docs/mobile/snippets/quickstart-prereqs.mdx",permalink:"/docs/mobile/snippets/quickstart-prereqs",editUrl:"https://github.com/geocortex/dev-center/edit/master/docs/mobile/snippets/quickstart-prereqs.mdx"},c=[],p={rightToc:c};function d(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Check out and setup the ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-overview"}),"Geocortex Mobile SDK Quickstart project"),"."))}d.isMDXComponent=!0},144:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return d}));var a=n(2),i=n(9),o=(n(0),n(298)),r={},s={id:"snippets/autofac-mobile",isDocsHomePage:!1,title:"autofac-mobile",description:"Geocortex Mobile uses Autofac to register, locate, and inject components, services and other classes. See dependency injection for more info.",source:"@site/docs/snippets/autofac-mobile.mdx",permalink:"/docs/snippets/autofac-mobile",editUrl:"https://github.com/geocortex/dev-center/edit/master/docs/snippets/autofac-mobile.mdx"},c=[],p={rightToc:c};function d(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"Geocortex Mobile uses ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://autofaccn.readthedocs.io/en/latest/index.html"}),"Autofac")," to register, locate, and inject components, services and other classes. See ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-dependency-injection"}),"dependency injection")," for more info."))))}d.isMDXComponent=!0},196:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return d})),n.d(t,"metadata",(function(){return m})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return u}));var a=n(2),i=n(9),o=(n(0),n(298)),r=n(304),s=n(309),c=n(310),p=(n(144),n(133)),d=(n(322),n(323),{title:"Build a Service that Fetches Dynamic Data",description:"Geocortex Mobile - Implement a custom Service"}),m={id:"mobile/tutorial-implement-service-fetch-dynamic-data",isDocsHomePage:!1,title:"Build a Service that Fetches Dynamic Data",description:"Geocortex Mobile - Implement a custom Service",source:"@site/docs/mobile/tutorial-implement-service-fetch-dynamic-data.mdx",permalink:"/docs/mobile/tutorial-implement-service-fetch-dynamic-data",editUrl:"https://github.com/geocortex/dev-center/edit/master/docs/mobile/tutorial-implement-service-fetch-dynamic-data.mdx",sidebar:"mobile",previous:{title:"Pull Component Data from App Config",permalink:"/docs/mobile/tutorial-implement-component-participate-app-config"},next:{title:"Commands, Operations and Events Reference",permalink:"/docs/mobile/api-commands-operations-events"}},l=[{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Create a New Service",id:"create-a-new-service",children:[]},{value:"Relevant SDK Samples",id:"relevant-sdk-samples",children:[]},{value:"Next Steps",id:"next-steps",children:[]}],b={rightToc:l};function u(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"When extending Geocortex Mobile, you may find yourself creating multiple ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-components-overview"}),"components")," that have a shared concern, like a data source, or a REST endpoint call. Shared concerns like this present a good use case for creating a custom ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-services-overview"}),"service"),". Implementing a custom service in Geocortex Mobile allows you to implement logic and shared resources that are available on startup to any component. Custom Services are also the recommended way of registering implementations for ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-commands-operations#implementing-commands-and-operations"}),"custom commands and operations"),"."),Object(o.b)("p",null,"This article will guide you through creating a custom service that fetches data from a dynamic source and delivers it to components through an operation."),Object(o.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(o.b)(p.default,{mdxType:"QuickstartPrereqsSnippet"}),Object(o.b)("h2",{id:"create-a-new-service"},"Create a New Service"),Object(o.b)("p",null,"Create a new file ",Object(o.b)("inlineCode",{parentName:"p"},"services/CustomService.cs")," under the platform agnostic project.\nIn the file, add a new component class ",Object(o.b)("inlineCode",{parentName:"p"},"CustomService")," and ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-dependency-injection"}),"register it with ",Object(o.b)("strong",{parentName:"a"},"Autofac")),"."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs",metastring:'title="App1/App1/services/CustomService.cs"',title:'"App1/App1/services/CustomService.cs"'}),"using App1.Services;\nusing VertiGIS.Mobile.Composition;\nusing VertiGIS.Mobile.Composition.Services;\nusing System.Threading.Tasks;\n\n// highlight-next-line\n[assembly: Service(typeof(CustomService), PropertiesAutowired = true)]\nnamespace App1.Services\n{\n    // highlight-next-line\n    class CustomService : ServiceBase\n    {\n        public CustomService()\n            :base()\n        {\n            // on creation logic here\n        }\n        protected override Task DoInitialize()\n        {\n            // on initialization logic here\n            return Task.CompletedTask;\n        }\n    }\n}\n")),Object(o.b)("p",null,"Next, we can mock a dynamically updating data source that the service consumes. In a real application, this might be a webhook, or an RSS feed, or database."),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"It's essential to properly dispose of any managed resources, like the background thread in this example, to prevent ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-memory-leaks"}),"memory leaks"),"."))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs",metastring:'title="App1/App1/services/CustomService.cs"',title:'"App1/App1/services/CustomService.cs"'}),'using App1.Services;\nusing VertiGIS.Mobile.Composition;\nusing VertiGIS.Mobile.Composition.Logging;\nusing VertiGIS.Mobile.Composition.Services;\nusing System.Threading;\nusing System.Threading.Tasks;\n\n[assembly: Service(typeof(CustomService), PropertiesAutowired = true)]\nnamespace App1.Services\n{\n    class CustomService : ServiceBase\n    {\n        private bool disposed = false;\n        private Thread dataUpdater;\n        private int data = 0;\n        private async void _dataUpdater()\n        {\n            try\n            {\n                while (true)\n                {\n                    // Fetch data from a rest endpoint\n                    await Task.Run(() =>\n                    {\n                        // await data.fetch()\n                        data = data + 1;\n                        Logger.Debug($"Custom Service fetched new data. Current Value: {data}");\n                    });\n                    Thread.Sleep(3000);\n                }\n            }\n            catch (ThreadAbortException)\n            {\n                return;\n            }\n        }\n\n        public CustomService()\n            : base()\n        {\n            dataUpdater = new Thread(new ThreadStart(_dataUpdater));\n        }\n        protected override Task DoInitialize()\n        {\n            dataUpdater.Start();\n            return Task.CompletedTask;\n        }\n\n        protected override void Dispose(bool disposing)\n        {\n            if (disposed)\n            {\n                return;\n            }\n\n            if (disposing)\n            {\n                dataUpdater.Abort();\n            }\n\n            disposed = true;\n            base.Dispose(disposing);\n        }\n    }\n}\n')),Object(o.b)("p",null,"To expose this data source to other components and services, we can create a new operation, ",Object(o.b)("inlineCode",{parentName:"p"},"custom-data.fetch"),"."),Object(o.b)("p",null,"First, create a new ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-commands-operations#registration-with-operationsbase"}),"operations class")," and define a new operation."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs",metastring:'title="App1/App1/services/CustomOperations.cs"',title:'"App1/App1/services/CustomOperations.cs"'}),'using App1.Operations;\nusing VertiGIS.Mobile.Composition;\nusing VertiGIS.Mobile.Composition.Messaging;\nusing VertiGIS.Mobile.Infrastructure.Messaging;\n\n// highlight-next-line\n[assembly: Export(typeof(CustomOperations), SingleInstance = true)]\nnamespace App1.Operations\n{\n    class CustomOperations : OperationsBase\n    {\n        // highlight-next-line\n        public IOperation<int> FetchCustomData=> GetOperation<int>("custom-data.fetch");\n\n        public CustomOperations(IOperationRegistry operationRegistry)\n            : base(operationRegistry)\n        {\n        }\n    }\n}\n')),Object(o.b)("p",null,"Next, ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-dependency-injection"}),"inject the operation")," into your custom service and register an implementation that returns the dynamic data."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs",metastring:'title="App1/App1/services/CustomService.cs"',title:'"App1/App1/services/CustomService.cs"'}),'using App1.Operations;\nusing App1.Services;\nusing VertiGIS.Mobile.Composition;\nusing VertiGIS.Mobile.Composition.Logging;\nusing VertiGIS.Mobile.Composition.Messaging;\nusing VertiGIS.Mobile.Composition.Services;\nusing System.Threading;\nusing System.Threading.Tasks;\n\n[assembly: Service(typeof(CustomService), PropertiesAutowired = true)]\nnamespace App1.Services\n{\n    class CustomService : ServiceBase\n    {\n        private Thread dataUpdater;\n        private int data = 0;\n        private async void _dataUpdater()\n        {\n            try\n            {\n                while (true)\n                {\n                    // Fetch data from a rest endpoint\n                    await Task.Run(() =>\n                    {\n                        // await data.fetch()\n                        data = data + 1;\n                        Logger.Debug($"Custom Service fetched new data. Current Value: {data}");\n                    });\n                    Thread.Sleep(3000);\n                }\n            }\n            catch (ThreadAbortException)\n            {\n                return;\n            }\n\n        }\n\n        // highlight-start\n        private async Task<int> FetchData()\n        {\n            return data;\n        }\n        // highlight-end\n\n        public CustomService(CustomOperations customOperations)\n            :base()\n        {\n            // on creation logic here\n            // highlight-next-line\n            customOperations.FetchCustomData.RegisterExecute(FetchData, this);\n            dataUpdater = new Thread(new ThreadStart(_dataUpdater));\n        }\n        protected override Task DoInitialize()\n        {\n            // on initialization logic here\n            dataUpdater.Start();\n            return Task.CompletedTask;\n        }\n\n        protected override void Dispose(bool disposing)\n        {\n            // dispose of any held resources here\n            dataUpdater.Abort();\n            base.Dispose(disposing);\n\n        }\n\n\n    }\n}\n')),Object(o.b)("p",null,"You've now built a custom service that fetches from a dynamic data source and exposes that data to other components! You could take this farther by creating an event that informs components and services when the data has changed, or returning a reference from the fetch data operation that can be observed for changes."),Object(o.b)("h2",{id:"relevant-sdk-samples"},"Relevant SDK Samples"),Object(o.b)("p",null,"Check out the relevant Geocortex Mobile SDK Samples:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/geocortex/vertigis-mobile-samples/tree/master/Geocortex.Mobile.Samples/Geocortex.Mobile.Samples/Samples/Custom/Service"}),"Custom Service"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/geocortex/vertigis-mobile-samples/tree/master/Geocortex.Mobile.Samples/Geocortex.Mobile.Samples/Samples/CustomSamples/BasemapToggle"}),"Basemap Toggle that uses a Custom Service")))),Object(o.b)("h2",{id:"next-steps"},"Next Steps"),Object(o.b)(s.a,{mdxType:"UseCaseContainer"},Object(o.b)(c.a,{title:"Learn More About Services",description:"Take a deep dive into services in the Geocortex Mobile SDK",link:Object(r.a)("docs/mobile/sdk-services-reference"),mdxType:"UseCaseCard"})))}u.isMDXComponent=!0},309:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(0),i=n.n(a),o=n(129),r=n.n(o);function s(e){var t=e.children;return i.a.createElement("div",{className:r.a.root},t)}},310:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n(311);var a=n(305),i=n(0),o=n.n(i),r=n(300),s=n(130),c=n.n(s);function p(e){var t=e.title,n=e.description,i=e.link;return o.a.createElement("div",{className:Object(r.a)("card-demo",c.a.root)},o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card__header"},o.a.createElement("h3",null,t)),o.a.createElement("div",{className:"card__body"},o.a.createElement("p",null,n)),o.a.createElement("div",{className:"card__footer"},o.a.createElement(a.a,{className:"button button--secondary button--block",to:i},"Get Started"))))}}}]);