(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{186:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return b}));var a=n(1),o=n(9),i=(n(0),n(296)),c=n(302),s=n(301),r={title:"Dependency Injection",description:"Geocortex Mobile - Learn about dependency injection in Geocortex Mobile"},l={id:"mobile/sdk-dependency-injection",title:"Dependency Injection",description:"Geocortex Mobile - Learn about dependency injection in Geocortex Mobile",source:"@site/docs/mobile/sdk-dependency-injection.mdx",permalink:"/docs/mobile/sdk-dependency-injection",editUrl:"https://github.com/geocortex/dev-center/edit/master/docs/mobile/sdk-dependency-injection.mdx",sidebar:"mobile",previous:{title:"Events Reference",permalink:"/docs/mobile/sdk-events-reference"},next:{title:"Component and Service Interactions",permalink:"/docs/mobile/sdk-component-service-interactions"}},p=[{value:"Components and Services",id:"components-and-services",children:[]},{value:"List of Registration Assembly Attributes",id:"list-of-registration-assembly-attributes",children:[{value:"<code>Export</code>",id:"export",children:[]},{value:"<code>Component</code>",id:"component",children:[]},{value:"<code>AppItemComponent</code>",id:"appitemcomponent",children:[]},{value:"<code>Service</code>",id:"service",children:[]},{value:"<code>AppItem</code>",id:"appitem",children:[]},{value:"<code>View</code>",id:"view",children:[]},{value:"<code>ViewModel</code>",id:"viewmodel",children:[]}]},{value:"Managing Sub-Dependencies",id:"managing-sub-dependencies",children:[]},{value:"Relevant SDK Sample",id:"relevant-sdk-sample",children:[]}],m={rightToc:p};function b(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},m,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"If you are new to the concepts of ",Object(i.b)("strong",{parentName:"p"},"inversion of control")," and ",Object(i.b)("strong",{parentName:"p"},"dependency injection"),", check out ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://martinfowler.com/articles/injection.html"}),"this article by Martin Fowler"),"."))),Object(i.b)("p",null,"Geocortex Mobile relies heavily on inversion of control patterns to inject dependencies into its components and services. Under the hood, Geocortex Mobile uses ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://autofaccn.readthedocs.io/en/latest/index.html"}),"Autofac")," to register and inject components, services and other classes. To inject a dependency into a class in Geocortex Mobile, two things must happen."),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"The class to be injected must register itself with the autofac container."),Object(i.b)("li",{parentName:"ol"},"The class that requires the dependency must accept a concrete class or abstract interface in its constructor as a placeholder for the injected class.")),Object(i.b)("p",null,"A good example of this pattern is the ",Object(i.b)("inlineCode",{parentName:"p"},"AlertOperations")," class in the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/tutorial-implement-command-operation"}),"commands and operation")," tutorial ."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"using App1.Services.AlertOperations;\nusing Geocortex.Mobile.Composition;\nusing Geocortex.Mobile.Composition.Messaging;\nusing Geocortex.Mobile.Infrastructure.Messaging;\n\n[assembly: Export(typeof(AlertOperations), SingleInstance = true)]\nnamespace App1.Services.AlertOperations\n{\n    class AlertOperations : OperationsBase\n    {\n        public AlertOperations(IOperationRegistry operationRegistry)\n            : base(operationRegistry)\n        {\n        }\n    }\n}\n")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"This class both registers itself as a dependency, and has dependencies injected itself."),Object(i.b)("li",{parentName:"ul"},"The assembly attribute ",Object(i.b)("inlineCode",{parentName:"li"},"Export")," is part of the Geocortex Mobile SDK, and registers the class with Autofac as a singleton."),Object(i.b)("li",{parentName:"ul"},"The constructor of the class takes an object of the type ",Object(i.b)("inlineCode",{parentName:"li"},"IOperationRegistry"),". This dependency will be resolved by Autofac at runtime ",Object(i.b)("strong",{parentName:"li"},"when")," ",Object(i.b)("inlineCode",{parentName:"li"},"AlertOperations")," is injected by another class. Chaining dependency injection in this manner is both a common and best practice pattern in Geocortex Mobile.")),Object(i.b)("p",null,"This is an example of a class that injects ",Object(i.b)("inlineCode",{parentName:"p"},"AlertOperations"),", which will in turn inject an ",Object(i.b)("inlineCode",{parentName:"p"},"IOperationRegistry")," into itself."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"[assembly: Service(typeof(CustomService), PropertiesAutowired = true)]\nnamespace App1.Services\n{\n    class CustomService : ServiceBase\n    {\n        public CustomService(AlertOperations AlertOperations)\n            :base()\n        {\n            ...\n        }\n    }\n    ...\n}\n")),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Autofac has a number of ways to inject dependencies, including factory functions which can dynamically spin up instances of a class or lazy wrappers for dependencies. For details, check out ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://autofaccn.readthedocs.io/en/latest/resolve/relationships.html"}),"the Autofac documentation.")))),Object(i.b)("h2",{id:"components-and-services"},"Components and Services"),Object(i.b)("p",null,"Components and services in Geocortex Mobile are almost always initialized by Autofac. This means that they can inject any class that has been registered with Autofac in their constructor, allowing classes used for behavior like ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/configuration-commands-operations"}),"commands and operations")," to be easily shared and loosely coupled to many components and services. Root level components (components that are instantiated from a layout definition) must ",Object(i.b)("strong",{parentName:"p"},"always")," register with Autofac to be correctly initialized, and it is best practice to use dependency injection to initialize instances of any other custom classes, services or components that the root level component depends on."),Object(i.b)("h2",{id:"list-of-registration-assembly-attributes"},"List of Registration Assembly Attributes"),Object(i.b)("p",null,"There's a number of different Geocortex Mobile specific assembly attributes which allow classes to register themselves with Geocortex Mobile's Autofac container."),Object(i.b)("h3",{id:"export"},Object(i.b)("inlineCode",{parentName:"h3"},"Export")),Object(i.b)("p",null,"Used for registering a generic class with Autofac."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"[assembly: Export(typeof(MyCustomClass))]\n")),Object(i.b)("h3",{id:"component"},Object(i.b)("inlineCode",{parentName:"h3"},"Component")),Object(i.b)("p",null,"Used for registering a component that ",Object(i.b)("strong",{parentName:"p"},"does not")," consume configuration. For a more detailed example, see the tutorial on ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/tutorial-implement-component-with-ui#create-a-component-skeleton"}),"implementing a custom component"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),'[assembly: Component(typeof(MyCustomComponent), "my-custom-component")]\n')),Object(i.b)("h3",{id:"appitemcomponent"},Object(i.b)("inlineCode",{parentName:"h3"},"AppItemComponent")),Object(i.b)("p",null,"Used for registering a component that ",Object(i.b)("strong",{parentName:"p"},"does")," consume configuration. For a more detailed example, see the tutorial on ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/tutorial-implement-component-participate-app-config#consume-the-configuration-in-the-component"}),"implementing a custom component with configuration"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),'[assembly: AppItemComponent(typeof(MyCustomComponent), "my-custom-component", MyCustomComponentConfiguration.ConfigItemtype)]\n')),Object(i.b)("h3",{id:"service"},Object(i.b)("inlineCode",{parentName:"h3"},"Service")),Object(i.b)("p",null,"Used for registering a service. For a more detailed example, see ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-services-create"}),"create a service"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"[assembly: Service(typeof(CustomService))]\n")),Object(i.b)("h3",{id:"appitem"},Object(i.b)("inlineCode",{parentName:"h3"},"AppItem")),Object(i.b)("p",null,"Used for registering the definition for an ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/configuration-app-config-reference#app-items"}),"app item")," with Geocortex Mobile. For a more detailed example, see the tutorial on ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/tutorial-implement-component-participate-app-config#create-a-skeleton-app-config-definition"}),"implementing a custom component with app configuration"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"[assembly: AppItem(CustomAppItem.AppItemType, typeof(CustomAppItem))]\n")),Object(i.b)("h3",{id:"view"},Object(i.b)("inlineCode",{parentName:"h3"},"View")),Object(i.b)("p",null,"Used for registering a ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/xamarin/xamarin-forms/enterprise-application-patterns/mvvm"}),"view")," with Geocortex Mobile. For a more detailed example see the tutorial on ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/tutorial-implement-component-with-ui#use-xaml-to-define-your-ui"}),"implementing a custom component with UI"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"[assembly: View(typeof(CustomView))]\n")),Object(i.b)("h3",{id:"viewmodel"},Object(i.b)("inlineCode",{parentName:"h3"},"ViewModel")),Object(i.b)("p",null,"Used for registering a ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/xamarin/xamarin-forms/enterprise-application-patterns/mvvm"}),"view model")," with Geocortex Mobile. For a more detailed example see the tutorial on ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/tutorial-implement-component-with-ui#example-progress-bar"}),"implementing a custom component with UI"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"[assembly: ViewModel(typeof(CustomViewModel))]\n")),Object(i.b)("h2",{id:"managing-sub-dependencies"},"Managing Sub-Dependencies"),Object(i.b)("p",null,"Sometimes, you may may want to split code associated with a component or service into multiple classes for individual views, utility functions, etc. Each of these classes may have dependencies on global classes registered with Autofac, such as operations, but only the registered component is instantiated by dependency injection, so only the component class can inject these global classes. One solution is to have the component class inject all the dependencies of it's associated classes and pass them to the class constructors, but this pattern introduces unnecessary boilerplate and coupling. Instead, if the component class creates instances of associated classes through dependency injection, then Autofac will automatically resolve any dependencies the associated class has."),Object(i.b)("p",null,"In the example below, the ",Object(i.b)("inlineCode",{parentName:"p"},"RelatedClass")," has a global dependency, ",Object(i.b)("inlineCode",{parentName:"p"},"MapOperations"),". In order to resolve this dependency, the ",Object(i.b)("inlineCode",{parentName:"p"},"CustomComponent")," creates an instance of the ",Object(i.b)("inlineCode",{parentName:"p"},"RelatedClass")," through dependency injection."),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Autofac allows for the injection of ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://autofaccn.readthedocs.io/en/latest/resolve/relationships.html#supported-relationship-types"}),"factory functions for classes, partially resolved class constructors, and more"),"."))),Object(i.b)(c.a,{defaultValue:"related",values:[{label:"Related Class",value:"related"},{label:"Component",value:"component"}],mdxType:"Tabs"},Object(i.b)(s.a,{value:"related",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"using Geocortex.Mobile.Composition;\nusing Geocortex.Mobile.Infrastructure.Messaging;\nusing Geocortex.Mobile.Samples.Samples.Custom.Component;\n\n// highlight-next-line\n[assembly: Export(typeof(RelatedClass))]\nnamespace Geocortex.Mobile.Samples.Samples.Custom.Component\n{\n    internal class RelatedClass\n    {\n        private MapOperations _mapOperations;\n\n        // highlight-next-line\n        public RelatedClass(MapOperations mapOperations)\n        {\n            _mapOperations = mapOperations;\n        }\n    }\n}\n"))),Object(i.b)(s.a,{value:"component",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),'using Geocortex.Mobile.Samples;\nusing Geocortex.Mobile.Samples.Samples.Custom.Component;\nusing Geocortex.Mobile.Composition.Layout;\nusing System.Xml.Linq;\nusing Xamarin.Forms;\n\n[assembly: Component(typeof(CustomComponent), "component", XmlNamespace = XmlNamespaces.SamplesNamespace)]\nnamespace Geocortex.Mobile.Samples.Samples.Custom.Component\n{\n    internal class CustomComponent : ComponentBase\n    {\n        private RelatedClass _relatedClass;\n\n        // highlight-next-line\n        public CustomComponent(RelatedClass relatedClass)\n        {\n            _relatedClass = relatedClass;\n        }\n\n        protected override VisualElement Create(XNode node)\n        {\n            return new Label()\n            {\n                Text = "Hello, World!",\n                HorizontalTextAlignment = TextAlignment.Center\n            };\n        }\n    }\n}\n')))),Object(i.b)("h2",{id:"relevant-sdk-sample"},"Relevant SDK Sample"),Object(i.b)("p",null,"Check out the Geocortex Mobile SDK Sample for ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/geocortex/vertigis-mobile-samples/tree/master/Geocortex.Mobile.Samples/Geocortex.Mobile.Samples/Samples/Conceptual/DependencyInjection"}),"dependency injection"),"."))}b.isMDXComponent=!0},300:function(e,t,n){"use strict";var a=n(0),o=Object(a.createContext)({tabGroupChoices:{},setTabGroupChoices:function(){}});t.a=o},301:function(e,t,n){"use strict";var a=n(0),o=n.n(a);t.a=function(e){return o.a.createElement("div",null,e.children)}},302:function(e,t,n){"use strict";n(26),n(21),n(22);var a=n(0),o=n.n(a),i=n(300);var c=function(){return Object(a.useContext)(i.a)},s=n(297),r=n.n(s),l=n(132),p=n.n(l),m=37,b=39;t.a=function(e){var t=e.block,n=e.children,i=e.defaultValue,s=e.values,l=e.groupId,d=c(),u=d.tabGroupChoices,h=d.setTabGroupChoices,j=Object(a.useState)(i),O=j[0],f=j[1];if(null!=l){var g=u[l];null!=g&&g!==O&&f(g)}var v=function(e){f(e),null!=l&&h(l,e)},y=[];return o.a.createElement("div",null,o.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:r()("tabs",{"tabs--block":t})},s.map((function(e){var t=e.value,n=e.label;return o.a.createElement("li",{role:"tab",tabIndex:"0","aria-selected":O===t,className:r()("tab-item",p.a.tabItem,{"tab-item--active":O===t}),key:t,ref:function(e){return y.push(e)},onKeyDown:function(e){return function(e,t,n){switch(n.keyCode){case b:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case m:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(y,e.target,e)},onFocus:function(){return v(t)},onClick:function(){return v(t)}},n)}))),o.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(n).filter((function(e){return e.props.value===O}))[0]))}}}]);