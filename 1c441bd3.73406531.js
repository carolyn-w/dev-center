(window.webpackJsonp=window.webpackJsonp||[]).push([[18,99],{100:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return p})),t.d(n,"metadata",(function(){return m})),t.d(n,"rightToc",(function(){return u})),t.d(n,"default",(function(){return d}));var a=t(2),o=t(6),i=(t(0),t(226)),r=(t(227),t(236)),s=t(237),c=t(68),p={title:"Commands and Operations",description:"Geocortex Mobile - Learn how to register and run commands and operations in custom services and components"},m={unversionedId:"mobile/sdk-commands-operations",id:"mobile/sdk-commands-operations",isDocsHomePage:!1,title:"Commands and Operations",description:"Geocortex Mobile - Learn how to register and run commands and operations in custom services and components",source:"@site/docs/mobile/sdk-commands-operations.mdx",slug:"/mobile/sdk-commands-operations",permalink:"/docs/mobile/sdk-commands-operations",editUrl:"https://github.com/geocortex/dev-center/edit/master/docs/mobile/sdk-commands-operations.mdx",version:"current",sidebar:"mobile",previous:{title:"Deployment",permalink:"/docs/mobile/sdk-deployment"},next:{title:"Components Overview",permalink:"/docs/mobile/sdk-components-overview"}},u=[{value:"Running Commands and Operations",id:"running-commands-and-operations",children:[]},{value:"Implementing Commands and Operations",id:"implementing-commands-and-operations",children:[{value:"Direct Registration and Implementation",id:"direct-registration-and-implementation",children:[]},{value:"Registration with <code>OperationsBase</code>",id:"registration-with-operationsbase",children:[]}]},{value:"Running Custom Commands",id:"running-custom-commands",children:[]},{value:"Relevant SDK Sample",id:"relevant-sdk-sample",children:[]}],l={rightToc:u};function d(e){var n=e.components,t=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"When writing custom components you may want to take advantage of Geocortex Mobile's large ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/api-commands-operations-events"}),"built-in suite of command and operations")," or your own ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/mobile/sdk-commands-operations#implementing-commands-and-operations"}),"custom commands and operations"),"."),Object(i.b)("h2",{id:"running-commands-and-operations"},"Running Commands and Operations"),Object(i.b)("p",null,"Services and components can run commands and operations through dependency injection."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"class CustomComponent : ComponentBase\n{\n    private readonly SystemOperations _systemOperations;\n\n    // highlight-next-line\n    public CustomComponent(SystemOperations systemOperations)\n    {\n        _systemOperations = systemOperations;\n    }\n\n    public async void CopyButtonClicked(string text)\n    {\n        // highlight-next-line\n        await _systemOperations.CopyToClipboard.ExecuteAsync(text);\n    }\n    ...\n}\n")),Object(i.b)("h2",{id:"implementing-commands-and-operations"},"Implementing Commands and Operations"),Object(i.b)("p",null,"Services and components can also register an implementation for any command or operation. Commands and operations can either be registered and implemented directly in a service or component, or registered in a class that extends ",Object(i.b)("inlineCode",{parentName:"p"},"OperationsBase")," for ease of use by other components and services."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Multiple implementations can be registered for a Command or Operation."))),Object(i.b)("h3",{id:"direct-registration-and-implementation"},"Direct Registration and Implementation"),Object(i.b)("p",null,"Commands and operations can be directly registered and implemented in a service or component through the ",Object(i.b)("inlineCode",{parentName:"p"},"IOperationRegistry"),".\nThis pattern can be useful for registering dynamically generated commands or implementations."),Object(i.b)(c.default,{mdxType:"CleanupHandlesSnippet"}),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),'class CustomService : ServiceBase\n{\n    private readonly IOperationRegistry _operationRegistry;\n\n    // highlight-start\n    public CustomService(IOperationRegistry operationRegistry)\n    {\n        // Define an operation that takes a string and returns the length of it.\n        operationRegistry.Operation<string, int>("custom.string-len").RegisterExecute(_executeStringLen, this);\n        // highlight-end\n    }\n\n    private async Task<int> _executeStringLen(string arg)\n    {\n        return arg != null ? arg.Length : 0;\n    }\n    ...\n}\n')),Object(i.b)("h3",{id:"registration-with-operationsbase"},"Registration with ",Object(i.b)("inlineCode",{parentName:"h3"},"OperationsBase")),Object(i.b)("p",null,"Commands and operations can also be defined in an ",Object(i.b)("inlineCode",{parentName:"p"},"OperationsBase")," class, which can then be injected into any service or component that wants to register an implementation."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"An ",Object(i.b)("inlineCode",{parentName:"li"},"IVoidOperation")," produces no output, and optionally takes an input.")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),'public IVoidOperation NoInputNoOutput => GetVoidOperation("fire.phasers");\npublic IVoidOperation<Temperature> SomeInputNoOutput => GetVoidOperation<Temperature>("tea.earl-grey");\n')),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"An ",Object(i.b)("inlineCode",{parentName:"li"},"IOperation")," produces an output, and optionally takes an input.")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),'public IOperation<SomeOutput> NoInputSomeOutput => GetOperation<SomeOutput>("custom.operation");\npublic IOperation<Deuterium, WarpSpeed> SomeInputSomeOutput => GetOperation<Deuterium, WarpSpeed>("warp-drive.engage");\n')),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Operation names in Geocortex Mobile generally take the format ",Object(i.b)("inlineCode",{parentName:"p"},"<category>.<name>"),", with multiple words ",Object(i.b)("inlineCode",{parentName:"p"},"kebab-cased"),"."))),Object(i.b)("p",null,"These types can be used to define a set of operations in an ",Object(i.b)("inlineCode",{parentName:"p"},"OperationsBase")," class that is registered with Autofac. Implementations for the operations can then be registered in a service or component."),Object(i.b)(r.a,{defaultValue:"operations",values:[{label:"OperationsBase",value:"operations"},{label:"Custom Component",value:"component"}],mdxType:"Tabs"},Object(i.b)(s.a,{value:"operations",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),'// highlight-next-line\n[assembly: Export(typeof(CustomOperations), SingleInstance = true)]\nnamespace App1.Operations\n{\n    class CustomOperations : OperationsBase\n    {\n        // highlight-start\n        public IVoidOperation<string> RunCustomCommand => GetVoidOperation<string>("custom.command-string-input");\n\n        public IOperation<int> RunCustomOperation => GetOperation<int>("custom.operation-int-output");\n\n        public IOperation<string, int> RunCustomOperationWithInput => GetOperation<string, int>("custom.operation-string-input-int-output");\n        // highlight-end\n\n        public Operation(IOperationRegistry operationRegistry)\n            : base(operationRegistry)\n        {\n        }\n    }\n}\n'))),Object(i.b)(s.a,{value:"component",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),"class CustomComponent : ComponentBase\n{\n    public CustomComponent(CustomOperations customOperations)\n    {\n        // highlight-start\n        customOperations.RunCustomCommand.RegisterExecute(_executeRunCustomCommand, this);\n\n        customOperations.RunCustomOperation.RegisterExecute(_executeRunCustomOperation, this);\n\n        customOperations.RunCustomOperationWithInput.RegisterExecute(_executeRunCustomOperationWithInput, this);\n        // highlight-end\n    }\n\n    private async Task _executeRunCustomCommand(string arg)\n    {\n        // ... implementation for run custom command.\n    }\n\n    private async Task<int> _executeRunCustomOperation()\n    {\n        // ... implementation for run custom operations.\n    }\n\n    private async Task<int> _executeRunCustomOperationWithInput(string arg)\n    {\n        // ... implementation for run custom operation with input.\n    }\n    ...\n}\n")))),Object(i.b)("h2",{id:"running-custom-commands"},"Running Custom Commands"),Object(i.b)("p",null,"You can run the custom commands or operations you define by either injecting the appropriate ",Object(i.b)("inlineCode",{parentName:"p"},"OperationsBase")," class or using the ",Object(i.b)("inlineCode",{parentName:"p"},"IOperationRegistry")," to run the command or operation by name."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-cs"}),'class CustomService : ServiceBase\n{\n    private readonly CustomOperations _customOperations;\n\n    private readonly IOperationRegistry _operationRegistry;\n\n    // highlight-next-line\n    public CustomService(CustomOperations customOperations, IOperationRegistry operationRegistry)\n    {\n        _customOperations = customOperations;\n        _operationRegistry = operationRegistry;\n    }\n\n    // highlight-start\n    private async void runSomeCommand()\n    {\n        await _customOperations.RunCustomCommand.ExecuteAsync("some arg");\n        // Execute the same operation but by name instead of through the `OperationsBase` container.\n        await _operationRegistry.VoidOperation("custom.command-string-input").ExecuteAsync("Some arg");\n    }\n    // highlight-end\n    ...\n}\n')),Object(i.b)("h2",{id:"relevant-sdk-sample"},"Relevant SDK Sample"),Object(i.b)("p",null,"The Geocortex Mobile SDK Samples project has a sample of ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/geocortex/vertigis-mobile-samples/tree/master/Geocortex.Mobile.Samples/Geocortex.Mobile.Samples/Samples/Custom/Service"}),"implementing a command with a custom service"),"."))}d.isMDXComponent=!0},226:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return b}));var a=t(0),o=t.n(a);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var p=o.a.createContext({}),m=function(e){var n=o.a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},u=function(e){var n=m(e.components);return o.a.createElement(p.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return o.a.createElement(o.a.Fragment,{},n)}},d=o.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,r=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=m(t),d=a,b=u["".concat(r,".").concat(d)]||u[d]||l[d]||i;return t?o.a.createElement(b,s(s({ref:n},p),{},{components:t})):o.a.createElement(b,s({ref:n},p))}));function b(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,r=new Array(i);r[0]=d;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var p=2;p<i;p++)r[p]=t[p];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},227:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return r}));var a=t(230),o=t(228);function i(){var e=Object(a.a)().siteConfig,n=(e=void 0===e?{}:e).baseUrl,t=void 0===n?"/":n,i=e.url;return{withBaseUrl:function(e,n){return function(e,n,t,a){var i=void 0===a?{}:a,r=i.forcePrependBaseUrl,s=void 0!==r&&r,c=i.absolute,p=void 0!==c&&c;if(!t)return t;if(t.startsWith("#"))return t;if(Object(o.b)(t))return t;if(s)return n+t;var m=t.startsWith(n)?t:n+t.replace(/^\//,"");return p?e+m:m}(i,t,e,n)}}}function r(e,n){return void 0===n&&(n={}),(0,i().withBaseUrl)(e,n)}},228:function(e,n,t){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function o(e){return void 0!==e&&!a(e)}t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return o}))},229:function(e,n,t){"use strict";function a(e){var n,t,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(t=a(e[n]))&&(o&&(o+=" "),o+=t);else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}n.a=function(){for(var e,n,t=0,o="";t<arguments.length;)(e=arguments[t++])&&(n=a(e))&&(o&&(o+=" "),o+=n);return o}},230:function(e,n,t){"use strict";var a=t(0),o=t(19);n.a=function(){var e=Object(a.useContext)(o.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},234:function(e,n,t){"use strict";var a=t(0),o=Object(a.createContext)(void 0);n.a=o},235:function(e,n,t){"use strict";var a=t(0),o=t(234);n.a=function(){var e=Object(a.useContext)(o.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},236:function(e,n,t){"use strict";var a=t(0),o=t.n(a),i=t(235),r=t(229),s=t(48),c=t.n(s),p=37,m=39;n.a=function(e){var n=e.block,t=e.children,s=e.defaultValue,u=e.values,l=e.groupId,d=Object(i.a)(),b=d.tabGroupChoices,O=d.setTabGroupChoices,h=Object(a.useState)(s),g=h[0],v=h[1],f=Object(a.useState)(!1),j=f[0],y=f[1];if(null!=l){var C=b[l];null!=C&&C!==g&&u.some((function(e){return e.value===C}))&&v(C)}var w=function(e){v(e),null!=l&&O(l,e)},N=[],x=function(e){e.metaKey||e.altKey||e.ctrlKey||y(!0)},R=function(){y(!1)};return Object(a.useEffect)((function(){window.addEventListener("keydown",x),window.addEventListener("mousedown",R)}),[]),o.a.createElement("div",null,o.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(r.a)("tabs",{"tabs--block":n})},u.map((function(e){var n=e.value,t=e.label;return o.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":g===n,className:Object(r.a)("tabs__item",c.a.tabItem,{"tabs__item--active":g===n}),style:j?{}:{outline:"none"},key:n,ref:function(e){return N.push(e)},onKeyDown:function(e){!function(e,n,t){switch(t.keyCode){case m:!function(e,n){var t=e.indexOf(n)+1;e[t]?e[t].focus():e[0].focus()}(e,n);break;case p:!function(e,n){var t=e.indexOf(n)-1;e[t]?e[t].focus():e[e.length-1].focus()}(e,n)}}(N,e.target,e),x(e)},onFocus:function(){return w(n)},onClick:function(){w(n),y(!1)},onPointerDown:function(){return y(!1)}},t)}))),o.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(t).filter((function(e){return e.props.value===g}))[0]))}},237:function(e,n,t){"use strict";var a=t(0),o=t.n(a);n.a=function(e){return o.a.createElement("div",null,e.children)}},68:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return r})),t.d(n,"metadata",(function(){return s})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return m}));var a=t(2),o=t(6),i=(t(0),t(226)),r={},s={unversionedId:"mobile/snippets/cleanup-handles",id:"mobile/snippets/cleanup-handles",isDocsHomePage:!1,title:"cleanup-handles",description:"It is vital that subscription handles are cleaned up when the object is cleaned up, otherwise dangling references can occur. This can be done by implementing the IDisposable and IDisposableTracker interface, and then providing this as the second argument to a call to subscribe. ServiceBase and ComponentBase already implement these interfaces so you don't have to.",source:"@site/docs/mobile/snippets/cleanup-handles.mdx",slug:"/mobile/snippets/cleanup-handles",permalink:"/docs/mobile/snippets/cleanup-handles",editUrl:"https://github.com/geocortex/dev-center/edit/master/docs/mobile/snippets/cleanup-handles.mdx",version:"current"},c=[],p={rightToc:c};function m(e){var n=e.components,t=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("div",{className:"admonition admonition-important alert alert--info"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"important")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"It is vital that subscription handles are cleaned up when the object is cleaned up, otherwise dangling references can occur. This can be done by implementing the ",Object(i.b)("inlineCode",{parentName:"p"},"IDisposable")," and ",Object(i.b)("inlineCode",{parentName:"p"},"IDisposableTracker")," interface, and then providing ",Object(i.b)("inlineCode",{parentName:"p"},"this")," as the second argument to a call to subscribe. ",Object(i.b)("inlineCode",{parentName:"p"},"ServiceBase")," and ",Object(i.b)("inlineCode",{parentName:"p"},"ComponentBase")," already implement these interfaces so you don't have to."))))}m.isMDXComponent=!0}}]);