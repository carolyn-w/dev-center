(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{245:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return p})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return d})),n.d(t,"default",(function(){return u}));var a=n(1),i=n(9),o=(n(0),n(295)),r=(n(300),n(299)),l=n(298),s=n(303),c=n(302),p={title:"Serializable Properties",description:"Geocortex Web - Learn how to serialize and deserialize app config properties"},b={id:"web/sdk-serializable-properties",title:"Serializable Properties",description:"Geocortex Web - Learn how to serialize and deserialize app config properties",source:"@site/docs/web/sdk-serializable-properties.mdx",permalink:"/docs/web/sdk-serializable-properties",editUrl:"https://github.com/geocortex/dev-center/edit/master/docs/web/sdk-serializable-properties.mdx",sidebar:"web",previous:{title:"Events Reference",permalink:"/docs/web/sdk-events-reference"},next:{title:"Internationalization",permalink:"/docs/web/sdk-internationalization"}},d=[{value:"Defining a Serializable Class",id:"defining-a-serializable-class",children:[]},{value:"Populating the Class with Configuration Values.",id:"populating-the-class-with-configuration-values",children:[]},{value:"Serialization Modes",id:"serialization-modes",children:[]},{value:"Next Steps",id:"next-steps",children:[]}],m={rightToc:d};function u(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},m,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Geocortex Web uses static, plain, app config JSON files to represent settings and properties for various components and services in an application. At some point, each of the values in the JSON file must be serialized and populate a JavaScript object. Component models and custom services can both consume configuration; therefore, they must also define the logic for translating configuration to runtime values."),Object(o.b)("h2",{id:"defining-a-serializable-class"},"Defining a Serializable Class"),Object(o.b)("p",null,"In order for a component to participate in configuration, it must be marked as serializable with the ",Object(o.b)("inlineCode",{parentName:"p"},"@serializable")," decorator."),Object(o.b)(s.a,{defaultValue:"model",values:[{label:"Custom Component Model",value:"model"},{label:"Custom Service",value:"service"}],mdxType:"Tabs"},Object(o.b)(c.a,{value:"model",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"...\n// highlight-next-line\n@serializable\nexport default class ExampleComponentModel extends ComponentModelBase<\n    ExampleComponentModelProperties\n> {\n    items: Collection<string> = new Collection<string>();\n    ...\n}\n"))),Object(o.b)(c.a,{value:"service",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"...\n// highlight-next-line\n@serializable\nexport default class CustomServiceWithConfig extends ConfigurableServiceBase<\n    CustomServiceProperties\n> {\n   items: Collection<string> = new Collection<string>();\n\n")))),Object(o.b)("p",null,"Every serializable class extends a generically typed base class, like ",Object(o.b)("inlineCode",{parentName:"p"},"ComponentModelBase")," or ",Object(o.b)("inlineCode",{parentName:"p"},"ConfigurableServiceBase"),". The type passed into the base class is an interface consisting of primitive, serializable types, like ",Object(o.b)("inlineCode",{parentName:"p"},"number"),", ",Object(o.b)("inlineCode",{parentName:"p"},"string"),", ",Object(o.b)("inlineCode",{parentName:"p"},"array"),", ",Object(o.b)("inlineCode",{parentName:"p"},"boolean"),", etc. Each property on the interface will correspond exactly to a property in the app config JSON."),Object(o.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"Marking properties in the ",Object(o.b)("inlineCode",{parentName:"p"},"ComponentModelProperties")," interface as optional allows them to be left out of config and populated with default values. It's best practice to make properties optional and provide a default value if possible."))),Object(o.b)(s.a,{defaultValue:"model",values:[{label:"Custom Component Model",value:"model"},{label:"Custom Service",value:"service"},{label:"App Config",value:"config"}],mdxType:"Tabs"},Object(o.b)(c.a,{value:"model",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"...\n// highlight-start\ninterface ExampleComponentModelProperties extends ComponentModelProperties {\n    items?: string[];\n}\n// highlight-end\n\n@serializable\nexport default class ExampleComponentModel extends ComponentModelBase<\n    ExampleComponentModelProperties\n> {\n    items: Collection<string> = new Collection<string>();\n    ...\n}\n"))),Object(o.b)(c.a,{value:"service",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"...\n// highlight-start\ninterface CustomServiceProperties extends ComponentModelProperties {\n    items?: string[];\n}\n// highlight-end\n\n@serializable\nexport default class CustomServiceWithConfig extends ConfigurableServiceBase<\n    CustomServiceProperties\n> {\n   items: Collection<string> = new Collection<string>();\n\n"))),Object(o.b)(c.a,{value:"config",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n    "schemaVersion": "1.0",\n    "items": [\n        ...\n        {\n            "$type": "custom-service",\n            "id": "custom-service-config",\n            "title": "Custom Service Config",\n            // highlight-next-line\n            "items": ["some", "string", "values"]\n        },\n        {\n            "$type": "example-component-model",\n            "id": "example-component-model-config",\n            "title": "Example Component Model Config",\n            // highlight-next-line\n            "items": ["more", "string", "values"]\n        }\n        ...\n    ]\n}\n')))),Object(o.b)("h2",{id:"populating-the-class-with-configuration-values"},"Populating the Class with Configuration Values."),Object(o.b)("p",null,"The class is responsible for turning the ",Object(o.b)("inlineCode",{parentName:"p"},"ComponentModelProperties")," interface, which will be populated with primitive values from the app config JSON, into complex properties on the class object itself. This work is done through the ",Object(o.b)("inlineCode",{parentName:"p"},"_getSerializableProperties")," method."),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"_getSerializableProperties()")," method has a few purposes."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Provide deserialization logic from the ",Object(o.b)("inlineCode",{parentName:"li"},"ComponentModelProperties")," interface to class properties."),Object(o.b)("li",{parentName:"ol"},"Provide serialization logic from an class property to the ",Object(o.b)("inlineCode",{parentName:"li"},"ComponentModelProperties")," interface, which can be serialized in a JSON file."),Object(o.b)("li",{parentName:"ol"},"Provide a default value for the JSON object if one is not given in the app config.")),Object(o.b)("div",{className:"admonition admonition-important alert alert--info"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"important")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"It's key that the existing properties also get serialized through a call to ",Object(o.b)("inlineCode",{parentName:"p"},"super._getSerializableProperties()"),"."))),Object(o.b)("p",null,"In the following example, the serialization logic for the ",Object(o.b)("inlineCode",{parentName:"p"},"ExampleComponentModelProperties")," string array property ",Object(o.b)("inlineCode",{parentName:"p"},"items")," is defined. The corresponding class property is an ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-core-Collection.html"}),"ArcGIS API for JavaScript Collection"),". Therefore, the ",Object(o.b)("inlineCode",{parentName:"p"},"deserialize")," method takes each item from the string array, and adds it to to collection. The ",Object(o.b)("inlineCode",{parentName:"p"},"serialize")," method does the opposite, turning the collection into a plain string array. A default value for the ",Object(o.b)("inlineCode",{parentName:"p"},"string[]")," is also provided."),Object(o.b)(s.a,{defaultValue:"model",values:[{label:"Custom Component Model",value:"model"},{label:"Custom Service",value:"service"}],mdxType:"Tabs"},Object(o.b)(c.a,{value:"model",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),'...\ninterface ExampleComponentModelProperties extends ComponentModelProperties {\n    items?: string[];\n}\n\n\n@serializable\nexport default class ExampleComponentModel extends ComponentModelBase<\n    ExampleComponentModelProperties\n> {\n    items: Collection<string> = new Collection<string>();\n\n    ...\n\n    protected _getSerializableProperties(): PropertyDefs<\n        ExampleComponentModelProperties\n    > {\n        // highlight-next-line\n        const props = super._getSerializableProperties();\n        return {\n            ...props,\n            items: {\n\n                serializeModes: ["initial"],\n                default: ["Some Default Value"],\n                serialize: () => this.items.toArray(),\n                deserialize: (items: string[]) => {\n                    this.items.removeAll();\n                    this.items.addMany(items); s\n                },\n            },\n        };\n    }\n}\n'))),Object(o.b)(c.a,{value:"service",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),'...\ninterface CustomServiceProperties extends ComponentModelProperties {\n    items?: string[];\n}\n\n@serializable\nexport default class CustomServiceWithConfig extends ConfigurableServiceBase<\n    CustomServiceProperties\n> {\n    items: Collection<string> = new Collection<string>();\n\n    ...\n\n    protected _getSerializableProperties(): PropertyDefs<\n        ExampleComponentModelProperties\n    > {\n        // highlight-next-line\n        const props = super._getSerializableProperties();\n        return {\n            ...props,\n            items: {\n\n                serializeModes: ["initial"],\n                default: ["Some Default Value"],\n                serialize: () => this.items.toArray(),\n                deserialize: (items: string[]) => {\n                    this.items.removeAll();\n                    this.items.addMany(items); s\n                },\n            },\n        };\n    }\n}\n')))),Object(o.b)("p",null,"Already serializable properties such as ",Object(o.b)("inlineCode",{parentName:"p"},"boolean")," values or ",Object(o.b)("inlineCode",{parentName:"p"},"string")," values can have their serialization logic omitted."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),'...\ninterface ExampleComponentModelProperties extends ComponentModelProperties {\n    stringVal?: string;\n}\n\n@serializable\nexport default class ExampleComponentModel extends ComponentModelBase<\n    ExampleComponentModelProperties\n> {\n    stringVal: string;\n\n    protected _getSerializableProperties(): PropertyDefs<\n        ExampleComponentModelProperties\n    > {\n        const props = super._getSerializableProperties();\n        return {\n            ...props,\n            stringVal: {\n                serializeModes: ["initial"],\n                default: "Simple String Value",\n            },\n        };\n    }\n}\n')),Object(o.b)("h2",{id:"serialization-modes"},"Serialization Modes"),Object(o.b)("p",null,"Every property has a number of serialization modes it can use to persist the values."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),'export declare type SerializeMode = "initial" | "all" | "preferences";\n')),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"initial")," will serialize to the app config JSON only if it is different from the default."),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"all")," will serialize all values to the app config JSON every time."),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"preferences")," will serialize the value to storage which will persist between application loads, but only apply to a single user."),Object(o.b)("h2",{id:"next-steps"},"Next Steps"),Object(o.b)(l.a,{mdxType:"UseCaseContainer"},Object(o.b)(r.a,{title:"Check out the Component Reference for Configuration",description:"Learn more about how components interact with configuration",link:"sdk-components-reference#configuration",mdxType:"UseCaseCard"}),Object(o.b)(r.a,{title:"Check out the Service Reference for Configuration",description:"Learn more about how services interact with configuration",link:"sdk-services-reference#models-and-configuration",mdxType:"UseCaseCard"})))}u.isMDXComponent=!0},297:function(e,t,n){"use strict";var a=n(0),i=n(51);t.a=function(){return Object(a.useContext)(i.a)}},298:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(0),i=n.n(a),o=n(296),r=n.n(o),l=n(130),s=n.n(l);function c(e){var t=e.children;return i.a.createElement("div",{className:r()(s.a.root)},t)}},299:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n(305);var a=n(304),i=n(0),o=n.n(i),r=n(296),l=n.n(r),s=n(131),c=n.n(s);function p(e){var t=e.title,n=e.description,i=e.link;return o.a.createElement("div",{className:l()("card-demo",c.a.root)},o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card__header"},o.a.createElement("h3",null,t)),o.a.createElement("div",{className:"card__body"},o.a.createElement("p",null,n)),o.a.createElement("div",{className:"card__footer"},o.a.createElement(a.a,{className:"button button--secondary button--block",to:i},"Get Started"))))}},300:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n(306);var a=n(297);function i(e){var t=(Object(a.a)().siteConfig||{}).baseUrl,n=void 0===t?"/":t;if(!e)return e;return/^(https?:|\/\/)/.test(e)?e:e.startsWith("/")?n+e.slice(1):n+e}},301:function(e,t,n){"use strict";var a=n(0),i=Object(a.createContext)({tabGroupChoices:{},setTabGroupChoices:function(){}});t.a=i},302:function(e,t,n){"use strict";var a=n(0),i=n.n(a);t.a=function(e){return i.a.createElement("div",null,e.children)}},303:function(e,t,n){"use strict";n(26),n(21),n(22);var a=n(0),i=n.n(a),o=n(301);var r=function(){return Object(a.useContext)(o.a)},l=n(296),s=n.n(l),c=n(132),p=n.n(c),b=37,d=39;t.a=function(e){var t=e.block,n=e.children,o=e.defaultValue,l=e.values,c=e.groupId,m=r(),u=m.tabGroupChoices,h=m.setTabGroupChoices,f=Object(a.useState)(o),g=f[0],v=f[1];if(null!=c){var C=u[c];null!=C&&C!==g&&v(C)}var O=function(e){v(e),null!=c&&h(c,e)},j=[];return i.a.createElement("div",null,i.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:s()("tabs",{"tabs--block":t})},l.map((function(e){var t=e.value,n=e.label;return i.a.createElement("li",{role:"tab",tabIndex:"0","aria-selected":g===t,className:s()("tab-item",p.a.tabItem,{"tab-item--active":g===t}),key:t,ref:function(e){return j.push(e)},onKeyDown:function(e){return function(e,t,n){switch(n.keyCode){case d:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case b:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(j,e.target,e)},onFocus:function(){return O(t)},onClick:function(){return O(t)}},n)}))),i.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(n).filter((function(e){return e.props.value===g}))[0]))}}}]);